#include <stdlib.h>
#include <stdio.h>
#include <time.h>

#include "chip8_cpu.h"
#include "chip8_opcodes.h"

static const unsigned char FONTSET[80] = 
{
    0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
    0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
    0x90, 0x90, 0xF0, 0x10, 0x10, // 4
    0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
    0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
    0xF0, 0x10, 0x20, 0x40, 0x40, // 7
    0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
    0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
    0xF0, 0x90, 0xF0, 0x90, 0x90, // A
    0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
    0xF0, 0x80, 0x80, 0x80, 0xF0, // C
    0xE0, 0x90, 0x90, 0x90, 0xE0, // D
    0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
    0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

chip8_cpu_t * CHIP8_CPU = NULL;

void init(void) 
{
    //完成CPU结构内存分配及初始化
}

void destroy(void) 
{
    free(CHIP8_CPU);
    CHIP8_CPU = NULL;
}

int loadrom(const char *rom) 
{
}

void cycle(void)  //模拟一个指令周期
{
    // Fetch指令，从pc处每次取两个字节到opcode中

	// Increment the PC before we execute anything,  pc += 2;

	// Decode and Execute, 执行每条指令对应的行为, 调用oc_exec

	// Decrement the delay timer if it's been set，此处需要考虑60Hz与CPU每秒执行多少条指令的关系

	// Decrement the sound timer if it's been set，此处需要考虑60Hz与CPU每秒执行多少条指令的关系
 
}
